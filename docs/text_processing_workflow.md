# Рабочий процесс обработки текстовых документов

## Обзор

Данный процесс предназначен для обработки текстовых документов в формате DOCX с применением следующих этапов:

1. Конвертация DOCX в HTML
2. Проверка орфографии и грамматики с помощью LanguageTool
3. Автоматическое исправление очевидных ошибок
4. Применение типографических улучшений с помощью Typograf

## Используемые инструменты

- `convert_docx_to_html.py` - конвертация DOCX в HTML с использованием Pandoc
- `check_text_languagetool.py` - проверка текста с помощью LanguageTool
- `autocorrect_html_languagetool.py` - автоматическое исправление ошибок на основе отчета LanguageTool
- `typografize-md.js` - применение типографики к тексту

## Подготовка среды

Для работы процесса требуются:

1. Python 3
2. Pandoc
3. LanguageTool 6.6 (уже присутствует в проекте)
4. Node.js
5. Typograf 7.4.4 (уже присутствует в проекте)

## Использование скрипта

```bash
./build-book.sh <путь_к_docx_файлу>
```

Например:

```bash
./build-book.sh src/на\ эксперимент\ по\ проверке.docx
```

## Процесс обработки

1. **Конвертация DOCX в HTML**
   - Входной файл: DOCX документ
   - Выходной файл: HTML в директории `reports/<имя_файла>/`
   - Инструмент: `convert_docx_to_html.py`

2. **Проверка орфографии и грамматики**
   - Входной файл: HTML из этапа 1
   - Выходной файл: JSON-отчет в формате LanguageTool
   - Инструмент: `check_text_languagetool.py`

3. **Автоматическое исправление ошибок**
   - Входной файл: HTML и JSON-отчет
   - Выходной файл: Исправленный HTML
   - Инструмент: `autocorrect_html_languagetool.py`

4. **Применение типографики**
   - Промежуточная конвертация HTML в Markdown
   - Применение типографических улучшений
   - Конвертация обратно в HTML
   - Инструменты: Pandoc и `typografize-md.js`

## Результаты тестирования

Скрипт был протестирован на файле `src/на эксперимент по проверке.docx` и показал следующие результаты:

1. **Конвертация DOCX в HTML:** Успешно выполнена с сохранением структуры документа.

2. **Проверка орфографии с LanguageTool:** Обнаружены потенциальные ошибки, сформирован полный отчет в формате JSON.

3. **Автоматическое исправление ошибок:**
   - Обнаружены и автоматически отклонены потенциально неправильные исправления:
     - 'Солнцедара' -> 'Солнце дара' (правильно отклонено как имя собственное)
     - 'падцанской' -> 'падуанской' (правильно отклонено как имя собственное)
   - Создан лог отклоненных исправлений для анализа.

4. **Типографическая обработка:**
   - Успешно выполнена конвертация в Markdown и обратно в HTML.
   - Улучшено форматирование кавычек, тире и других типографских элементов.
   - Сохранены авторские особенности текста и диалектизмы.

Полный процесс обработки занял менее 10 секунд для данного документа, демонстрируя эффективность разработанного рабочего процесса.

## Результаты

По завершении процесса в директории `reports/<имя_файла>/` будут созданы следующие файлы:

- `<имя_файла>.html` - исходный HTML после конвертации
- `<имя_файла>_languagetool_report.json` - отчет о найденных ошибках
- `<имя_файла>.md` - промежуточный Markdown
- `<имя_файла>.typograf.md` - Markdown после типографики
- `<имя_файла>_processed.html` - финальный обработанный HTML

## Расширение процесса

Данный процесс можно расширить следующими этапами:

1. Конвертация финального HTML в другие форматы (PDF, EPUB)
2. Добавление проверки стиля текста
3. Автоматическая структуризация документа
4. Интеграция с другими инструментами проверки и улучшения текста

## Журнал обработки

Все этапы процесса записываются в файл `process.log`, что позволяет отслеживать результаты и выявлять возможные проблемы. 